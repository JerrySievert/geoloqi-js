var JSON;JSON||(JSON={}),function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(a){return a<10?"0"+a:a}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();(function(a,b,c,d,e,f){function u(a,b){var c=typeof a[b];return c=="function"||c=="object"&&!!a[b]||c=="unknown"}function v(a,b){return typeof a[b]=="object"&&!!a[b]}function w(a){return Object.prototype.toString.call(a)==="[object Array]"}function x(){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return s=Array.prototype.slice.call(a.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),t=parseInt(s[0],10)>9&&parseInt(s[1],10)>0,a=null,!0}catch(b){return!1}}function D(){if(A)return;A=!0;for(var a=0;a<B.length;a++)B[a]();B.length=0}function F(a,b){if(A){a.call(b);return}B.push(function(){a.call(b)})}function G(){var a=parent;if(m!=="")for(var b=0,c=m.split(".");b<c.length;b++)a=a[c[b]];return a.easyXDM}function H(b){return a.easyXDM=o,m=b,m&&(p="easyXDM_"+m.replace(".","_")+"_"),n}function I(a){return a.match(j)[3]}function J(a){return a.match(j)[4]||""}function K(a){var b=a.toLowerCase().match(j),c=b[2],d=b[3],e=b[4]||"";if(c=="http:"&&e==":80"||c=="https:"&&e==":443")e="";return c+"//"+d+e}function L(a){a=a.replace(l,"$1/");if(!a.match(/^(http||https):\/\//)){var b=a.substring(0,1)==="/"?"":c.pathname;b.substring(b.length-1)!=="/"&&(b=b.substring(0,b.lastIndexOf("/")+1)),a=c.protocol+"//"+c.host+b+a}while(k.test(a))a=a.replace(k,"");return a}function M(a,b){var c="",d=a.indexOf("#");d!==-1&&(c=a.substring(d),a=a.substring(0,d));var e=[];for(var g in b)b.hasOwnProperty(g)&&e.push(g+"="+f(b[g]));return a+(r?"#":a.indexOf("?")==-1?"?":"&")+e.join("&")+c}function O(a){return typeof a=="undefined"}function Q(a,b,c){var d;for(var e in b)b.hasOwnProperty(e)&&(e in a?(d=b[e],typeof d=="object"?Q(a[e],d,c):c||(a[e]=b[e])):a[e]=b[e]);return a}function R(){var a=b.body.appendChild(b.createElement("form")),c=a.appendChild(b.createElement("input"));c.name=p+"TEST"+h,q=c!==a.elements[c.name],b.body.removeChild(a)}function S(a){O(q)&&R();var c;q?c=b.createElement('<iframe name="'+a.props.name+'"/>'):(c=b.createElement("IFRAME"),c.name=a.props.name),c.id=c.name=a.props.name,delete a.props.name,a.onLoad&&y(c,"load",a.onLoad),typeof a.container=="string"&&(a.container=b.getElementById(a.container)),a.container||(Q(c.style,{position:"absolute",top:"-2000px"}),a.container=b.body);var d=a.props.src;return delete a.props.src,Q(c,a.props),c.border=c.frameBorder=0,c.allowTransparency=!0,a.container.appendChild(c),c.src=d,a.props.src=d,c}function T(a,b){typeof a=="string"&&(a=[a]);var c,d=a.length;while(d--){c=a[d],c=new RegExp(c.substr(0,1)=="^"?c:"^"+c.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$");if(c.test(b))return!0}return!1}function U(d){var e=d.protocol,f;d.isHost=d.isHost||O(N.xdm_p),r=d.hash||!1,d.props||(d.props={});if(!d.isHost){d.channel=N.xdm_c,d.secret=N.xdm_s,d.remote=N.xdm_e,e=N.xdm_p;if(d.acl&&!T(d.acl,d.remote))throw new Error("Access denied for "+d.remote)}else d.remote=L(d.remote),d.channel=d.channel||"default"+h++,d.secret=Math.random().toString(16).substring(2),O(e)&&(K(c.href)==K(d.remote)?e="4":u(a,"postMessage")||u(b,"postMessage")?e="1":d.swf&&u(a,"ActiveXObject")&&x()?e="6":navigator.product==="Gecko"&&"frameElement"in a&&navigator.userAgent.indexOf("WebKit")==-1?e="5":d.remoteHelper?(d.remoteHelper=L(d.remoteHelper),e="2"):e="0");d.protocol=e;switch(e){case"0":Q(d,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0);if(d.isHost){if(!d.local){var g=c.protocol+"//"+c.host,i=b.body.getElementsByTagName("img"),j,k=i.length;while(k--){j=i[k];if(j.src.substring(0,g.length)===g){d.local=j.src;break}}d.local||(d.local=a)}var l={xdm_c:d.channel,xdm_p:0};d.local===a?(d.usePolling=!0,d.useParent=!0,d.local=c.protocol+"//"+c.host+c.pathname+c.search,l.xdm_e=d.local,l.xdm_pa=1):l.xdm_e=L(d.local),d.container&&(d.useResize=!1,l.xdm_po=1),d.remote=M(d.remote,l)}else Q(d,{channel:N.xdm_c,remote:N.xdm_e,useParent:!O(N.xdm_pa),usePolling:!O(N.xdm_po),useResize:d.useParent?!1:d.useResize});f=[new n.stack.HashTransport(d),new n.stack.ReliableBehavior({}),new n.stack.QueueBehavior({encode:!0,maxLength:4e3-d.remote.length}),new n.stack.VerifyBehavior({initiate:d.isHost})];break;case"1":f=[new n.stack.PostMessageTransport(d)];break;case"2":f=[new n.stack.NameTransport(d),new n.stack.QueueBehavior,new n.stack.VerifyBehavior({initiate:d.isHost})];break;case"3":f=[new n.stack.NixTransport(d)];break;case"4":f=[new n.stack.SameOriginTransport(d)];break;case"5":f=[new n.stack.FrameElementTransport(d)];break;case"6":s||x(),f=[new n.stack.FlashTransport(d)]}return f.push(new n.stack.QueueBehavior({lazy:d.lazy,remove:!0})),f}function V(a){var b,c={incoming:function(a,b){this.up.incoming(a,b)},outgoing:function(a,b){this.down.outgoing(a,b)},callback:function(a){this.up.callback(a)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var d=0,e=a.length;d<e;d++)b=a[d],Q(b,c,!0),d!==0&&(b.down=a[d-1]),d!==e-1&&(b.up=a[d+1]);return b}function W(a){a.up.down=a.down,a.down.up=a.up,a.up=a.down=null}var g=this,h=Math.floor(Math.random()*1e4),i=Function.prototype,j=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,k=/[\-\w]+\/\.\.\//,l=/([^:])\/\//g,m="",n={},o=a.easyXDM,p="easyXDM_",q,r=!1,s,t,y,z;if(u(a,"addEventListener"))y=function(a,b,c){a.addEventListener(b,c,!1)},z=function(a,b,c){a.removeEventListener(b,c,!1)};else if(u(a,"attachEvent"))y=function(a,b,c){a.attachEvent("on"+b,c)},z=function(a,b,c){a.detachEvent("on"+b,c)};else throw new Error("Browser not supported");var A=!1,B=[],C;"readyState"in b?(C=b.readyState,A=C=="complete"||~navigator.userAgent.indexOf("AppleWebKit/")&&(C=="loaded"||C=="interactive")):A=!!b.body;if(!A){if(u(a,"addEventListener"))y(b,"DOMContentLoaded",D);else{y(b,"readystatechange",function(){b.readyState=="complete"&&D()});if(b.documentElement.doScroll&&a===top){var E=function(){if(A)return;try{b.documentElement.doScroll("left")}catch(a){d(E,1);return}D()};E()}}y(a,"load",D)}var N=function(a){a=a.substring(1).split("&");var b={},c,d=a.length;while(d--)c=a[d].split("="),b[c[0]]=e(c[1]);return b}(/xdm_e=/.test(c.search)?c.search:c.hash),P=function(){var a={},b={a:[1,2,3]},c='{"a":[1,2,3]}';return typeof JSON!="undefined"&&typeof JSON.stringify=="function"&&JSON.stringify(b).replace(/\s/g,"")===c?JSON:(Object.toJSON&&Object.toJSON(b).replace(/\s/g,"")===c&&(a.stringify=Object.toJSON),typeof String.prototype.evalJSON=="function"&&(b=c.evalJSON(),b.a&&b.a.length===3&&b.a[2]===3&&(a.parse=function(a){return a.evalJSON()})),a.stringify&&a.parse?(P=function(){return a},a):null)};Q(n,{version:"2.4.15.118",query:N,stack:{},apply:Q,getJSONObject:P,whenReady:F,noConflict:H}),n.DomHelper={on:y,un:z,requiresJSON:function(c){v(a,"JSON")||b.write('<script type="text/javascript" src="'+c+'"></script>')}},function(){var a={};n.Fn={set:function(b,c){a[b]=c},get:function(b,c){var d=a[b];return c&&delete a[b],d}}}(),n.Socket=function(a){var b=V(U(a).concat([{incoming:function(b,c){a.onMessage(b,c)},callback:function(b){a.onReady&&a.onReady(b)}}])),c=K(a.remote);this.origin=K(a.remote),this.destroy=function(){b.destroy()},this.postMessage=function(a){b.outgoing(a,c)},b.init()},n.Rpc=function(a,b){if(b.local)for(var c in b.local)if(b.local.hasOwnProperty(c)){var d=b.local[c];typeof d=="function"&&(b.local[c]={method:d})}var e=V(U(a).concat([new n.stack.RpcBehavior(this,b),{callback:function(b){a.onReady&&a.onReady(b)}}]));this.origin=K(a.remote),this.destroy=function(){e.destroy()},e.init()},n.stack.SameOriginTransport=function(a){var b,e,f,g;return b={outgoing:function(a,b,c){f(a),c&&c()},destroy:function(){e&&(e.parentNode.removeChild(e),e=null)},onDOMReady:function(){g=K(a.remote),a.isHost?(Q(a.props,{src:M(a.remote,{xdm_e:c.protocol+"//"+c.host+c.pathname,xdm_c:a.channel,xdm_p:4}),name:p+a.channel+"_provider"}),e=S(a),n.Fn.set(a.channel,function(a){return f=a,d(function(){b.up.callback(!0)},0),function(a){b.up.incoming(a,g)}})):(f=G().Fn.get(a.channel,!0)(function(a){b.up.incoming(a,g)}),d(function(){b.up.callback(!0)},0))},init:function(){F(b.onDOMReady,b)}}},n.stack.FlashTransport=function(a){function l(a,b){d(function(){e.up.incoming(a,i)},0)}function o(c){var d=a.swf+"?host="+a.isHost,e="easyXDM_swf_"+Math.floor(Math.random()*1e4);n.Fn.set("flash_loaded"+c.replace(/[\-.]/g,"_"),function(){n.stack.FlashTransport[c].swf=j=k.firstChild;var a=n.stack.FlashTransport[c].queue;for(var b=0;b<a.length;b++)a[b]();a.length=0}),a.swfContainer?k=typeof a.swfContainer=="string"?b.getElementById(a.swfContainer):a.swfContainer:(k=b.createElement("div"),Q(k.style,t&&a.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),b.body.appendChild(k));var f="callback=flash_loaded"+c.replace(/[\-.]/g,"_")+"&proto="+g.location.protocol+"&domain="+I(g.location.href)+"&port="+J(g.location.href)+"&ns="+m;k.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+e+"' data='"+d+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+d+"'></param><param name='flashvars' value='"+f+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+f+"' allowScriptAccess='always' wmode='transparent' src='"+d+"' height='1' width='1'></embed></object>"}var e,f,h,i,j,k;return e={outgoing:function(b,c,d){j.postMessage(a.channel,b.toString()),d&&d()},destroy:function(){try{j.destroyChannel(a.channel)}catch(b){}j=null,f&&(f.parentNode.removeChild(f),f=null)},onDOMReady:function(){i=a.remote,n.Fn.set("flash_"+a.channel+"_init",function(){d(function(){e.up.callback(!0)})}),n.Fn.set("flash_"+a.channel+"_onMessage",l),a.swf=L(a.swf);var b=I(a.swf),g=function(){n.stack.FlashTransport[b].init=!0,j=n.stack.FlashTransport[b].swf,j.createChannel(a.channel,a.secret,K(a.remote),a.isHost),a.isHost&&(t&&a.swfNoThrottle&&Q(a.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),Q(a.props,{src:M(a.remote,{xdm_e:K(c.href),xdm_c:a.channel,xdm_p:6,xdm_s:a.secret}),name:p+a.channel+"_provider"}),f=S(a))};n.stack.FlashTransport[b]&&n.stack.FlashTransport[b].init?g():n.stack.FlashTransport[b]?n.stack.FlashTransport[b].queue.push(g):(n.stack.FlashTransport[b]={queue:[g]},o(b))},init:function(){F(e.onDOMReady,e)}}},n.stack.PostMessageTransport=function(b){function i(a){if(a.origin)return K(a.origin);if(a.uri)return K(a.uri);if(a.domain)return c.protocol+"//"+a.domain;throw"Unable to retrieve the origin of the event"}function j(a){var c=i(a);c==h&&a.data.substring(0,b.channel.length+1)==b.channel+" "&&e.up.incoming(a.data.substring(b.channel.length+1),c)}var e,f,g,h;return e={outgoing:function(a,c,d){g.postMessage(b.channel+" "+a,c||h),d&&d()},destroy:function(){z(a,"message",j),f&&(g=null,f.parentNode.removeChild(f),f=null)},onDOMReady:function(){h=K(b.remote);if(b.isHost){var i=function(c){c.data==b.channel+"-ready"&&(g="postMessage"in f.contentWindow?f.contentWindow:f.contentWindow.document,z(a,"message",i),y(a,"message",j),d(function(){e.up.callback(!0)},0))};y(a,"message",i),Q(b.props,{src:M(b.remote,{xdm_e:K(c.href),xdm_c:b.channel,xdm_p:1}),name:p+b.channel+"_provider"}),f=S(b)}else y(a,"message",j),g="postMessage"in a.parent?a.parent:a.parent.document,g.postMessage(b.channel+"-ready",h),d(function(){e.up.callback(!0)},0)},init:function(){F(e.onDOMReady,e)}}},n.stack.FrameElementTransport=function(e){var f,g,h,i;return f={outgoing:function(a,b,c){h.call(this,a),c&&c()},destroy:function(){g&&(g.parentNode.removeChild(g),g=null)},onDOMReady:function(){i=K(e.remote),e.isHost?(Q(e.props,{src:M(e.remote,{xdm_e:K(c.href),xdm_c:e.channel,xdm_p:5}),name:p+e.channel+"_provider"}),g=S(e),g.fn=function(a){return delete g.fn,h=a,d(function(){f.up.callback(!0)},0),function(a){f.up.incoming(a,i)}}):(b.referrer&&K(b.referrer)!=N.xdm_e&&(a.top.location=N.xdm_e),h=a.frameElement.fn(function(a){f.up.incoming(a,i)}),f.up.callback(!0))},init:function(){F(f.onDOMReady,f)}}},n.stack.NameTransport=function(a){function k(b){var d=a.remoteHelper+(c?"#_3":"#_2")+a.channel;e.contentWindow.sendMessage(b,d)}function l(){c?(++g===2||!c)&&b.up.callback(!0):(k("ready"),b.up.callback(!0))}function m(a){b.up.incoming(a,i)}function o(){h&&d(function(){h(!0)},0)}var b,c,e,f,g,h,i,j;return b={outgoing:function(a,b,c){h=c,k(a)},destroy:function(){e.parentNode.removeChild(e),e=null,c&&(f.parentNode.removeChild(f),f=null)},onDOMReady:function(){c=a.isHost,g=0,i=K(a.remote),a.local=L(a.local),c?(n.Fn.set(a.channel,function(b){c&&b==="ready"&&(n.Fn.set(a.channel,m),l())}),j=M(a.remote,{xdm_e:a.local,xdm_c:a.channel,xdm_p:2}),Q(a.props,{src:j+"#"+a.channel,name:p+a.channel+"_provider"}),f=S(a)):(a.remoteHelper=a.remote,n.Fn.set(a.channel,m)),e=S({props:{src:a.local+"#_4"+a.channel},onLoad:function b(){var c=e||this;z(c,"load",b),n.Fn.set(a.channel+"_load",o),function f(){typeof c.contentWindow.sendMessage=="function"?l():d(f,50)}()}})},init:function(){F(b.onDOMReady,b)}}},n.stack.HashTransport=function(b){function o(a){if(!l)return;var c=b.remote+"#"+j++ +"_"+a;(f||!m?l.contentWindow:l).location=c}function q(a){i=a,c.up.incoming(i.substring(i.indexOf("_")+1),n)}function r(){if(!k)return;var a=k.location.href,b="",c=a.indexOf("#");c!=-1&&(b=a.substring(c)),b&&b!=i&&q(b)}function s(){g=setInterval(r,h)}var c,e=this,f,g,h,i,j,k,l,m,n;return c={outgoing:function(a,b){o(a)},destroy:function(){a.clearInterval(g),(f||!m)&&l.parentNode.removeChild(l),l=null},onDOMReady:function(){f=b.isHost,h=b.interval,i="#"+b.channel,j=0,m=b.useParent,n=K(b.remote);if(f){b.props={src:b.remote,name:p+b.channel+"_provider"};if(m)b.onLoad=function(){k=a,s(),c.up.callback(!0)};else{var e=0,g=b.delay/50;(function o(){if(++e>g)throw new Error("Unable to reference listenerwindow");try{k=l.contentWindow.frames[p+b.channel+"_consumer"]}catch(a){}k?(s(),c.up.callback(!0)):d(o,50)})()}l=S(b)}else k=a,s(),m?(l=parent,c.up.callback(!0)):(Q(b,{props:{src:b.remote+"#"+b.channel+new Date,name:p+b.channel+"_consumer"},onLoad:function(){c.up.callback(!0)}}),l=S(b))},init:function(){F(c.onDOMReady,c)}}},n.stack.ReliableBehavior=function(a){var b,c,d=0,e=0,f="";return b={incoming:function(a,g){var h=a.indexOf("_"),i=a.substring(0,h).split(",");a=a.substring(h+1),i[0]==d&&(f="",c&&c(!0)),a.length>0&&(b.down.outgoing(i[1]+","+d+"_"+f,g),e!=i[1]&&(e=i[1],b.up.incoming(a,g)))},outgoing:function(a,g,h){f=a,c=h,b.down.outgoing(e+","+ ++d+"_"+a,g)}}},n.stack.QueueBehavior=function(a){function m(){if(a.remove&&c.length===0){W(b);return}if(g||c.length===0||i)return;g=!0;var e=c.shift();b.down.outgoing(e.data,e.origin,function(a){g=!1,e.callback&&d(function(){e.callback(a)},0),m()})}var b,c=[],g=!0,h="",i,j=0,k=!1,l=!1;return b={init:function(){O(a)&&(a={}),a.maxLength&&(j=a.maxLength,l=!0),a.lazy?k=!0:b.down.init()},callback:function(a){g=!1;var c=b.up;m(),c.callback(a)},incoming:function(c,d){if(l){var f=c.indexOf("_"),g=parseInt(c.substring(0,f),10);h+=c.substring(f+1),g===0&&(a.encode&&(h=e(h)),b.up.incoming(h,d),h="")}else b.up.incoming(c,d)},outgoing:function(d,e,g){a.encode&&(d=f(d));var h=[],i;if(l){while(d.length!==0)i=d.substring(0,j),d=d.substring(i.length),h.push(i);while(i=h.shift())c.push({data:h.length+"_"+i,origin:e,callback:h.length===0?g:null})}else c.push({data:d,origin:e,callback:g});k?b.down.init():m()},destroy:function(){i=!0,b.down.destroy()}}},n.stack.VerifyBehavior=function(a){function f(){c=Math.random().toString(16).substring(2),b.down.outgoing(c)}var b,c,d,e=!1;return b={incoming:function(e,g){var h=e.indexOf("_");h===-1?e===c?b.up.callback(!0):d||(d=e,a.initiate||f(),b.down.outgoing(e)):e.substring(0,h)===d&&b.up.incoming(e.substring(h+1),g)},outgoing:function(a,d,e){b.down.outgoing(c+"_"+a,d,e)},callback:function(b){a.initiate&&f()}}},n.stack.RpcBehavior=function(a,b){function g(a){a.jsonrpc="2.0",c.down.outgoing(d.stringify(a))}function h(a,b){var c=Array.prototype.slice;return function(){var d=arguments.length,h,i={method:b};d>0&&typeof arguments[d-1]=="function"?(d>1&&typeof arguments[d-2]=="function"?(h={success:arguments[d-2],error:arguments[d-1]},i.params=c.call(arguments,0,d-2)):(h={success:arguments[d-1]},i.params=c.call(arguments,0,d-1)),f[""+ ++e]=h,i.id=e):i.params=c.call(arguments,0),a.namedParams&&i.params.length===1&&(i.params=i.params[0]),g(i)}}function j(a,b,c,d){if(!c){b&&g({id:b,error:{code:-32601,message:"Procedure not found."}});return}var e,f;b?(e=function(a){e=i,g({id:b,result:a})},f=function(a,c){f=i;var d={id:b,error:{code:-32099,message:a}};c&&(d.error.data=c),g(d)}):e=f=i,w(d)||(d=[d]);try{var h=c.method.apply(c.scope,d.concat([e,f]));O(h)||e(h)}catch(j){f(j.message)}}var c,d=b.serializer||P(),e=0,f={};return c={incoming:function(a,c){var e=d.parse(a);if(e.method)b.handle?b.handle(e,g):j(e.method,e.id,b.local[e.method],e.params);else{var h=f[e.id];e.error?h.error&&h.error(e.error):h.success&&h.success(e.result),delete f[e.id]}},init:function(){if(b.remote)for(var d in b.remote)b.remote.hasOwnProperty(d)&&(a[d]=h(b.remote[d],d));c.down.init()},destroy:function(){for(var d in b.remote)b.remote.hasOwnProperty(d)&&a.hasOwnProperty(d)&&delete a[d];c.down.destroy()}}},g.easyXDM=n})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);/*! Socket.IO.js build:0.8.4, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed *//**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */(function(a){var b=a;b.version="0.8.4",b.protocol=1,b.transports=[],b.j=[],b.sockets={},b.connect=function(a,c){var d=b.util.parseUri(a),e,f;"undefined"!=typeof document&&(d.protocol=d.protocol||document.location.protocol.slice(0,-1),d.host=d.host||document.domain,d.port=d.port||document.location.port),e=b.util.uniqueUri(d);var g={host:d.host,secure:"https"==d.protocol,port:d.port||("https"==d.protocol?443:80),query:d.query||""};b.util.merge(g,c);if(g["force new connection"]||!b.sockets[e])f=new b.Socket(g);return!g["force new connection"]&&f&&(b.sockets[e]=f),f=f||b.sockets[e],f.of(d.path.length>1?d.path:"")}})("object"==typeof module?module.exports:window.io={}),function(a,b){var c=a.util={},d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];c.parseUri=function(a){var b=d.exec(a||""),c={},f=14;while(f--)c[e[f]]=b[f]||"";return c},c.uniqueUri=function(a){var c=a.protocol,d=a.host,e=a.port;return"document"in b?(d=d||document.domain,e=e||(c=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(d=d||"localhost",!e&&c=="https"&&(e=443)),(c||"http")+"://"+d+":"+(e||80)},c.query=function(a,b){var d=c.chunkQuery(a||""),e=[];c.merge(d,c.chunkQuery(b||""));for(var f in d)d.hasOwnProperty(f)&&e.push(f+"="+d[f]);return e.length?"?"+e.join("&"):""},c.chunkQuery=function(a){var b={},c=a.split("&"),d=0,e=c.length,f;for(;d<e;++d)f=c[d].split("="),f[0]&&(b[f[0]]=decodeURIComponent(f[1]));return b};var f=!1;c.load=function(a){if("document"in b&&document.readyState==="complete"||f)return a();c.on(b,"load",a,!1)},c.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},c.request=function(a){if("undefined"!=typeof window){if(a&&window.XDomainRequest)return new XDomainRequest;if(window.XMLHttpRequest&&(!a||c.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}return null},"undefined"!=typeof window&&c.load(function(){f=!0}),c.defer=function(a){if(!c.ua.webkit)return a();c.load(function(){setTimeout(a,100)})},c.merge=function g(a,b,d,e){var f=e||[],g=typeof d=="undefined"?2:d,h;for(h in b)b.hasOwnProperty(h)&&c.indexOf(f,h)<0&&(typeof a[h]!="object"||!g?(a[h]=b[h],f.push(b[h])):c.merge(a[h],b[h],g-1,f));return a},c.mixin=function(a,b){c.merge(a.prototype,b.prototype)},c.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c},c.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},c.intersect=function(a,b){var d=[],e=a.length>b.length?a:b,f=a.length>b.length?b:a;for(var g=0,h=f.length;g<h;g++)~c.indexOf(e,f[g])&&d.push(f[g]);return d},c.indexOf=function(a,b,c){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b,c);for(var d=a.length,c=c<0?c+d<0?0:c+d:c||0;c<d&&a[c]!==b;c++);return d<=c?-1:c},c.toArray=function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(a[c]);return b},c.ua={},c.ua.hasCORS="undefined"!=typeof window&&window.XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(b){return!1}return a.withCredentials!=undefined}(),c.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}("undefined"!=typeof window?io:module.exports,this),function(a,b){function c(){}a.EventEmitter=c,c.prototype.on=function(a,c){return this.$events||(this.$events={}),this.$events[a]?b.util.isArray(this.$events[a])?this.$events[a].push(c):this.$events[a]=[this.$events[a],c]:this.$events[a]=c,this},c.prototype.addListener=c.prototype.on,c.prototype.once=function(a,b){function d(){c.removeListener(a,d),b.apply(this,arguments)}var c=this;return d.listener=b,this.on(a,d),this},c.prototype.removeListener=function(a,c){if(this.$events&&this.$events[a]){var d=this.$events[a];if(b.util.isArray(d)){var e=-1;for(var f=0,g=d.length;f<g;f++)if(d[f]===c||d[f].listener&&d[f].listener===c){e=f;break}if(e<0)return this;d.splice(e,1),d.length||delete this.$events[a]}else(d===c||d.listener&&d.listener===c)&&delete this.$events[a]}return this},c.prototype.removeAllListeners=function(a){return this.$events&&this.$events[a]&&(this.$events[a]=null),this},c.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),b.util.isArray(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},c.prototype.emit=function(a){if(!this.$events)return!1;var c=this.$events[a];if(!c)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof c)c.apply(this,d);else{if(!b.util.isArray(c))return!1;var e=c.slice();for(var f=0,g=e.length;f<g;f++)e[f].apply(this,d)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function f(a){return a<10?"0"+a:a}function date(a,b){return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i instanceof Date&&(i=date(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict";if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,typeof JSON!="undefined"?JSON:undefined),function(a,b){var c=a.parser={},d=c.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],e=c.reasons=["transport not supported","client not handshaken","unauthorized"],f=c.advice=["reconnect"],g=b.JSON,h=b.util.indexOf;c.encodePacket=function(a){var b=h(d,a.type),c=a.id||"",i=a.endpoint||"",j=a.ack,k=null;switch(a.type){case"error":var l=a.reason?h(e,a.reason):"",m=a.advice?h(f,a.advice):"";if(l!==""||m!=="")k=l+(m!==""?"+"+m:"");break;case"message":a.data!==""&&(k=a.data);break;case"event":var n={name:a.name};a.args&&a.args.length&&(n.args=a.args),k=g.stringify(n);break;case"json":k=g.stringify(a.data);break;case"connect":a.qs&&(k=a.qs);break;case"ack":k=a.ackId+(a.args&&a.args.length?"+"+g.stringify(a.args):"")}var o=[b,c+(j=="data"?"+":""),i];return k!==null&&k!==undefined&&o.push(k),o.join(":")},c.encodePayload=function(a){var b="";if(a.length==1)return a[0];for(var c=0,d=a.length;c<d;c++){var e=a[c];b+="�"+e.length+"�"+a[c]}return b};var i=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;c.decodePacket=function(a){var b=a.match(i);if(!b)return{};var c=b[2]||"",a=b[5]||"",h={type:d[b[1]],endpoint:b[4]||""};c&&(h.id=c,b[3]?h.ack="data":h.ack=!0);switch(h.type){case"error":var b=a.split("+");h.reason=e[b[0]]||"",h.advice=f[b[1]]||"";break;case"message":h.data=a||"";break;case"event":try{var j=g.parse(a);h.name=j.name,h.args=j.args}catch(k){}h.args=h.args||[];break;case"json":try{h.data=g.parse(a)}catch(k){}break;case"connect":h.qs=a||"";break;case"ack":var b=a.match(/^([0-9]+)(\+)?(.*)/);if(b){h.ackId=b[1],h.args=[];if(b[3])try{h.args=b[3]?g.parse(b[3]):[]}catch(k){}}break;case"disconnect":case"heartbeat":}return h},c.decodePayload=function(a){if(a.charAt(0)=="�"){var b=[];for(var d=1,e="";d<a.length;d++)a.charAt(d)=="�"?(b.push(c.decodePacket(a.substr(d+1).substr(0,e))),d+=Number(e)+1,e=""):e+=a.charAt(d);return b}return[c.decodePacket(a)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b){function c(a,b){this.socket=a,this.sessid=b}a.Transport=c,b.util.mixin(c,b.EventEmitter),c.prototype.onData=function(a){this.clearCloseTimeout(),this.setCloseTimeout();if(a!==""){var c=b.parser.decodePayload(a);if(c&&c.length)for(var d=0,e=c.length;d<e;d++)this.onPacket(c[d])}return this},c.prototype.onPacket=function(a){return a.type=="heartbeat"?this.onHeartbeat():(a.type=="connect"&&a.endpoint==""&&this.onConnect(),this.socket.onPacket(a),this)},c.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}},c.prototype.onDisconnect=function(){return this.close&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},c.prototype.onConnect=function(){return this.socket.onConnect(),this},c.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},c.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},c.prototype.packet=function(a){this.send(b.parser.encodePacket(a))},c.prototype.onHeartbeat=function(a){this.packet({type:"heartbeat"})},c.prototype.onOpen=function(){this.open=!0,this.clearCloseTimeout(),this.socket.onOpen()},c.prototype.onClose=function(){var a=this;this.open=!1,this.setCloseTimeout(),this.socket.onClose()},c.prototype.prepareUrl=function(){var a=this.socket.options;return this.scheme()+"://"+a.host+":"+a.port+"/"+a.resource+"/"+b.protocol+"/"+this.name+"/"+this.sessid},c.prototype.ready=function(a,b){b.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(a){this.options={port:80,secure:!1,document:"document"in c?document:!1,resource:"socket.io",transports:b.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},b.util.merge(this.options,a),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||b.util.ua.hasCORS)){var d=this;b.util.on(c,"beforeunload",function(){d.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function e(){}a.Socket=d,b.util.mixin(d,b.EventEmitter),d.prototype.of=function(a){return this.namespaces[a]||(this.namespaces[a]=new b.SocketNamespace(this,a),a!==""&&this.namespaces[a].packet({type:"connect"})),this.namespaces[a]},d.prototype.publish=function(){this.emit.apply(this,arguments);var a;for(var b in this.namespaces)this.namespaces.hasOwnProperty(b)&&(a=this.of(b),a.$emit.apply(a,arguments))},d.prototype.handshake=function(a){function f(b){b instanceof Error?c.onError(b.message):a.apply(null,b.split(":"))}var c=this,d=this.options,g=["http"+(d.secure?"s":"")+":/",d.host+":"+d.port,this.options.resource,b.protocol,b.util.query(this.options.query,"t="+ +(new Date))].join("/");if(this.isXDomain()){var h=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src=g+"&jsonp="+b.j.length,h.parentNode.insertBefore(i,h),b.j.push(function(a){f(a),i.parentNode.removeChild(i)})}else{var j=b.util.request();j.open("GET",g,!0),j.onreadystatechange=function(){j.readyState==4&&(j.onreadystatechange=e,j.status==200?f(j.responseText):!c.reconnecting&&c.onError(j.responseText))},j.send(null)}},d.prototype.getTransport=function(a){var c=a||this.transports,d;for(var e=0,f;f=c[e];e++)if(b.Transport[f]&&b.Transport[f].check(this)&&(!this.isXDomain()||b.Transport[f].xdomainCheck()))return new b.Transport[f](this,this.sessionid);return null},d.prototype.connect=function(a){if(this.connecting)return this;var c=this;return this.handshake(function(d,e,f,g){function h(a){c.transport&&c.transport.clearTimeouts(),c.transport=c.getTransport(a);if(!c.transport)return c.publish("connect_failed");c.transport.ready(c,function(){c.connecting=!0,c.publish("connecting",c.transport.name),c.transport.open(),c.options["connect timeout"]&&(c.connectTimeoutTimer=setTimeout(function(){if(!c.connected){c.connecting=!1;if(c.options["try multiple transports"]){c.remainingTransports||(c.remainingTransports=c.transports.slice(0));var a=c.remainingTransports;while(a.length>0&&a.splice(0,1)[0]!=c.transport.name);a.length?h(a):c.publish("connect_failed")}}},c.options["connect timeout"]))})}c.sessionid=d,c.closeTimeout=f*1e3,c.heartbeatTimeout=e*1e3,c.transports=b.util.intersect(g.split(","),c.options.transports),h(),c.once("connect",function(){clearTimeout(c.connectTimeoutTimer),a&&typeof a=="function"&&a()})}),this},d.prototype.packet=function(a){return this.connected&&!this.doBuffer?this.transport.packet(a):this.buffer.push(a),this},d.prototype.setBuffer=function(a){this.doBuffer=a,!a&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},d.prototype.disconnect=function(){return this.connected&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},d.prototype.disconnectSync=function(){var a=b.util.request(),c=this.resource+"/"+b.protocol+"/"+this.sessionid;a.open("GET",c,!0),this.onDisconnect("booted")},d.prototype.isXDomain=function(){var a=window.location.port||("https:"==window.location.protocol?443:80);return this.options.host!==document.domain||this.options.port!=a},d.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},d.prototype.onOpen=function(){this.open=!0},d.prototype.onClose=function(){this.open=!1},d.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)},d.prototype.onError=function(a){a&&a.advice&&a.advice==="reconnect"&&this.connected&&(this.disconnect(),this.reconnect()),this.publish("error",a&&a.reason?a.reason:a)},d.prototype.onDisconnect=function(a){var b=this.connected;this.connected=!1,this.connecting=!1,this.open=!1,b&&(this.transport.close(),this.transport.clearTimeouts(),this.publish("disconnect",a),"booted"!=a&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},d.prototype.reconnect=function(){function e(){if(a.connected){for(var b in a.namespaces)a.namespaces.hasOwnProperty(b)&&""!==b&&a.namespaces[b].packet({type:"connect"});a.publish("reconnect",a.transport.name,a.reconnectionAttempts)}a.removeListener("connect_failed",f),a.removeListener("connect",f),a.reconnecting=!1,delete a.reconnectionAttempts,delete a.reconnectionDelay,delete a.reconnectionTimer,delete a.redoTransports,a.options["try multiple transports"]=c}function f(){if(!a.reconnecting)return;if(a.connected)return e();if(a.connecting&&a.reconnecting)return a.reconnectionTimer=setTimeout(f,1e3);a.reconnectionAttempts++>=b?a.redoTransports?(a.publish("reconnect_failed"),e()):(a.on("connect_failed",f),a.options["try multiple transports"]=!0,a.transport=a.getTransport(),a.redoTransports=!0,a.connect()):(a.reconnectionDelay<d&&(a.reconnectionDelay*=2),a.connect(),a.publish("reconnecting",a.reconnectionDelay,a.reconnectionAttempts),a.reconnectionTimer=setTimeout(f,a.reconnectionDelay))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var a=this,b=this.options["max reconnection attempts"],c=this.options["try multiple transports"],d=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(f,this.reconnectionDelay),this.on("connect",f)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a,b){this.socket=a,this.name=b||"",this.flags={},this.json=new d(this,"json"),this.ackPackets=0,this.acks={}}function d(a,b){this.namespace=a,this.name=b}a.SocketNamespace=c,b.util.mixin(c,b.EventEmitter),c.prototype.$emit=b.EventEmitter.prototype.emit,c.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},c.prototype.packet=function(a){return a.endpoint=this.name,this.socket.packet(a),this.flags={},this},c.prototype.send=function(a,b){var c={type:this.flags.json?"json":"message",data:a};return"function"==typeof b&&(c.id=++this.ackPackets,c.ack=!0,this.acks[c.id]=b),this.packet(c)},c.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),c=b[b.length-1],d={type:"event",name:a};return"function"==typeof c&&(d.id=++this.ackPackets,d.ack="data",this.acks[d.id]=c,b=b.slice(0,b.length-1)),d.args=b,this.packet(d)},c.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},c.prototype.onPacket=function(a){function d(){c.packet({type:"ack",args:b.util.toArray(arguments),ackId:a.id})}var c=this;switch(a.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?this.socket.onDisconnect(a.reason||"booted"):this.$emit("disconnect",a.reason);break;case"message":case"json":var e=["message",a.data];a.ack=="data"?e.push(d):a.ack&&this.packet({type:"ack",ackId:a.id}),this.$emit.apply(this,e);break;case"event":var e=[a.name].concat(a.args);a.ack=="data"&&e.push(d),this.$emit.apply(this,e);break;case"ack":this.acks[a.ackId]&&(this.acks[a.ackId].apply(this,a.args),delete this.acks[a.ackId]);break;case"error":a.advice?this.socket.onError(a):a.reason=="unauthorized"?this.$emit("connect_failed",a.reason):this.$emit("error",a.reason)}},d.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},d.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b){function c(a){b.Transport.apply(this,arguments)}a.websocket=c,b.util.inherit(c,b.Transport),c.prototype.name="websocket",c.prototype.open=function(){var a=b.util.query(this.socket.options.query),c=this,d;return d||(d=window.MozWebSocket||window.WebSocket),this.websocket=new d(this.prepareUrl()+a),this.websocket.onopen=function(){c.onOpen(),c.socket.setBuffer(!1)},this.websocket.onmessage=function(a){c.onData(a.data)},this.websocket.onclose=function(){c.onClose(),c.socket.setBuffer(!0)},this.websocket.onerror=function(a){c.onError(a)},this},c.prototype.send=function(a){return this.websocket.send(a),this},c.prototype.payload=function(a){for(var b=0,c=a.length;b<c;b++)this.packet(a[b]);return this},c.prototype.close=function(){return this.websocket.close(),this},c.prototype.onError=function(a){this.socket.onError(a)},c.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},c.check=function(){return"WebSocket"in window&&!("__addTask"in WebSocket)||"MozWebSocket"in window},c.xdomainCheck=function(){return!0},b.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b){function c(){b.Transport.websocket.apply(this,arguments)}a.flashsocket=c,b.util.inherit(c,b.Transport.websocket),c.prototype.name="flashsocket",c.prototype.open=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.open.apply(a,c)}),this},c.prototype.send=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.send.apply(a,c)}),this},c.prototype.close=function(){return WebSocket.__tasks.length=0,b.Transport.websocket.prototype.close.call(this),this},c.prototype.ready=function(a,d){function e(){var b=a.options,e=b["flash policy port"],g=["http"+(b.secure?"s":"")+":/",b.host+":"+b.port,b.resource,"static/flashsocket","WebSocketMain"+(a.isXDomain()?"Insecure":"")+".swf"];c.loaded||(typeof WEB_SOCKET_SWF_LOCATION=="undefined"&&(WEB_SOCKET_SWF_LOCATION=g.join("/")),e!==843&&WebSocket.loadFlashPolicyFile("xmlsocket://"+b.host+":"+e),WebSocket.__initialize(),c.loaded=!0),d.call(f)}var f=this;if(document.body)return e();b.util.load(e)},c.check=function(){return typeof WebSocket!="undefined"&&"__initialize"in WebSocket&&!!swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},c.xdomainCheck=function(){return!0},typeof window!="undefined"&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),b.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);var swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=i.getElementsByTagName("body")[0],d=Q(b);d.setAttribute("type",e);var f=c.appendChild(d);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var j=y.ie&&y.win?"ActiveX":"PlugIn",k="MMredirectURL="+h.location.toString().replace(/&/g,"%26")+"&MMplayerType="+j+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+k:c.flashvars=k;if(y.ie&&y.win&&g.readyState!=4){var l=Q("div");d+="SWFObjectNew",l.setAttribute("id",d),g.parentNode.insertBefore(l,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=a)try{var s=new ActiveXObject(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}();(function(){if(window.WebSocket)return;var a=window.console;if(!a||!a.log||!a.error)a={log:function(){},error:function(){}};if(!swfobject.hasFlashPlayerVersion("10.0.0")){a.error("Flash Player >= 10.0.0 is required.");return}location.protocol=="file:"&&a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(a,b,c,d,e){var f=this;f.__id=WebSocket.__nextId++,WebSocket.__instances[f.__id]=f,f.readyState=WebSocket.CONNECTING,f.bufferedAmount=0,f.__events={},b?typeof b=="string"&&(b=[b]):b=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(f.__id,a,b,c||null,d||0,e||null)})},0)},WebSocket.prototype.send=function(a){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var b=WebSocket.__flash.send(this.__id,encodeURIComponent(a));return b<0?!0:(this.bufferedAmount+=b,!1)},WebSocket.prototype.close=
function(){if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING)return;this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id)},WebSocket.prototype.addEventListener=function(a,b,c){a in this.__events||(this.__events[a]=[]),this.__events[a].push(b)},WebSocket.prototype.removeEventListener=function(a,b,c){if(!(a in this.__events))return;var d=this.__events[a];for(var e=d.length-1;e>=0;--e)if(d[e]===b){d.splice(e,1);break}},WebSocket.prototype.dispatchEvent=function(a){var b=this.__events[a.type]||[];for(var c=0;c<b.length;++c)b[c](a);var d=this["on"+a.type];d&&d(a)},WebSocket.prototype.__handleEvent=function(a){"readyState"in a&&(this.readyState=a.readyState),"protocol"in a&&(this.protocol=a.protocol);var b;if(a.type=="open"||a.type=="error")b=this.__createSimpleEvent(a.type);else if(a.type=="close")b=this.__createSimpleEvent("close");else{if(a.type!="message")throw"unknown event type: "+a.type;var c=decodeURIComponent(a.message);b=this.__createMessageEvent("message",c)}this.dispatchEvent(b)},WebSocket.prototype.__createSimpleEvent=function(a){if(document.createEvent&&window.Event){var b=document.createEvent("Event");return b.initEvent(a,!1,!1),b}return{type:a,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(a,b){if(document.createEvent&&window.MessageEvent&&!window.opera){var c=document.createEvent("MessageEvent");return c.initMessageEvent("message",!1,!1,b,null,null,window,null),c}return{type:a,data:b,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(a){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(a)})},WebSocket.__initialize=function(){if(WebSocket.__flash)return;WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation);if(!window.WEB_SOCKET_SWF_LOCATION){a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}var b=document.createElement("div");b.id="webSocketContainer",b.style.position="absolute",WebSocket.__isFlashLite()?(b.style.left="0px",b.style.top="0px"):(b.style.left="-100px",b.style.top="-100px");var c=document.createElement("div");c.id="webSocketFlash",b.appendChild(c),document.body.appendChild(b),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(b){b.success||a.error("[WebSocket] swfobject.embedSWF failed")})},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var a=0;a<WebSocket.__tasks.length;++a)WebSocket.__tasks[a]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{var b=WebSocket.__flash.receiveEvents();for(var c=0;c<b.length;++c)WebSocket.__instances[b[c].webSocketId].__handleEvent(b[c])}catch(d){a.error(d)}},0),!0},WebSocket.__log=function(b){a.log(decodeURIComponent(b))},WebSocket.__error=function(b){a.error(decodeURIComponent(b))},WebSocket.__addTask=function(a){WebSocket.__flash?a():WebSocket.__tasks.push(a)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var a=window.navigator.mimeTypes["application/x-shockwave-flash"];return!a||!a.enabledPlugin||!a.enabledPlugin.filename?!1:a.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))})(),function(a,b,c){function d(a){if(!a)return;b.Transport.apply(this,arguments),this.sendBuffer=[]}function e(){}a.XHR=d,b.util.inherit(d,b.Transport),d.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},d.prototype.payload=function(a){var c=[];for(var d=0,e=a.length;d<e;d++)c.push(b.parser.encodePacket(a[d]));this.send(b.parser.encodePayload(c))},d.prototype.send=function(a){return this.post(a),this},d.prototype.post=function(a){function d(){this.readyState==4&&(this.onreadystatechange=e,b.posting=!1,this.status==200?b.socket.setBuffer(!1):b.onClose())}function f(){this.onload=e,b.socket.setBuffer(!1)}var b=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),c.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=f:this.sendXHR.onreadystatechange=d,this.sendXHR.send(a)},d.prototype.close=function(){return this.onClose(),this},d.prototype.request=function(a){var c=b.util.request(this.socket.isXDomain()),d=b.util.query(this.socket.options.query,"t="+ +(new Date));c.open(a||"GET",this.prepareUrl()+d,!0);if(a=="POST")try{c.setRequestHeader?c.setRequestHeader("Content-type","text/plain;charset=UTF-8"):c.contentType="text/plain"}catch(e){}return c},d.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},d.check=function(a,c){try{if(b.util.request(c))return!0}catch(d){}return!1},d.xdomainCheck=function(){return d.check(null,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a){b.Transport.XHR.apply(this,arguments)}a.htmlfile=c,b.util.inherit(c,b.Transport.XHR),c.prototype.name="htmlfile",c.prototype.get=function(){this.doc=new ActiveXObject("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var a=this.doc.createElement("div");a.className="socketio",this.doc.body.appendChild(a),this.iframe=this.doc.createElement("iframe"),a.appendChild(this.iframe);var c=this,d=b.util.query(this.socket.options.query,"t="+ +(new Date));this.iframe.src=this.prepareUrl()+d,b.util.on(window,"unload",function(){c.destroy()})},c.prototype._=function(a,b){this.onData(a);try{var c=b.getElementsByTagName("script")[0];c.parentNode.removeChild(c)}catch(d){}},c.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(a){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},c.prototype.close=function(){return this.destroy(),b.Transport.XHR.prototype.close.call(this)},c.check=function(){if("ActiveXObject"in window)try{var a=new ActiveXObject("htmlfile");return a&&b.Transport.XHR.check()}catch(c){}return!1},c.xdomainCheck=function(){return!1},b.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(){b.Transport.XHR.apply(this,arguments)}function e(){}a["xhr-polling"]=d,b.util.inherit(d,b.Transport.XHR),b.util.merge(d,b.Transport.XHR),d.prototype.name="xhr-polling",d.prototype.open=function(){var a=this;return b.Transport.XHR.prototype.open.call(a),!1},d.prototype.get=function(){function b(){this.readyState==4&&(this.onreadystatechange=e,this.status==200?(a.onData(this.responseText),a.get()):a.onClose())}function d(){this.onload=e,a.onData(this.responseText),a.get()}if(!this.open)return;var a=this;this.xhr=this.request(),c.XDomainRequest&&this.xhr instanceof XDomainRequest?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=b,this.xhr.send(null)},d.prototype.onClose=function(){b.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=e;try{this.xhr.abort()}catch(a){}this.xhr=null}},d.prototype.ready=function(a,c){var d=this;b.util.defer(function(){c.call(d)})},b.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a){b.Transport["xhr-polling"].apply(this,arguments),this.index=b.j.length;var c=this;b.j.push(function(a){c._(a)})}a["jsonp-polling"]=c,b.util.inherit(c,b.Transport["xhr-polling"]),c.prototype.name="jsonp-polling",c.prototype.post=function(a){function i(){j(),c.socket.setBuffer(!1)}function j(){c.iframe&&c.form.removeChild(c.iframe);try{h=document.createElement('<iframe name="'+c.iframeId+'">')}catch(a){h=document.createElement("iframe"),h.name=c.iframeId}h.id=c.iframeId,c.form.appendChild(h),c.iframe=h}var c=this,d=b.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);if(!this.form){var e=document.createElement("form"),f=document.createElement("textarea"),g=this.iframeId="socketio_iframe_"+this.index,h;e.className="socketio",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.target=g,e.method="POST",e.setAttribute("accept-charset","utf-8"),f.name="d",e.appendChild(f),document.body.appendChild(e),this.form=e,this.area=f}this.form.action=this.prepareUrl()+d,j(),this.area.value=a;try{this.form.submit()}catch(k){}this.iframe.attachEvent?h.onreadystatechange=function(){c.iframe.readyState=="complete"&&i()}:this.iframe.onload=i,this.socket.setBuffer(!0)},c.prototype.get=function(){var a=this,c=document.createElement("script"),d=b.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),c.async=!0,c.src=this.prepareUrl()+d,c.onerror=function(){a.onClose()};var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(c,e),this.script=c},c.prototype._=function(a){return this.onData(a),this.open&&this.get(),this},c.check=function(){return!0},c.xdomainCheck=function(){return!0},b.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);var geoloqi=function(){function s(a){var b=document.location.hash.substring(1),e={};d.auth=JSON.parse(o.cookie.get()),c.config=a,b!==""&&t(b)}function t(a){var b=o.objectify(a);b.access_token&&b.expires_in&&(d.auth=b,o.cookie.set(JSON.stringify(b),b.expires_in),d.onAuthorize!==null&&d.onAuthorize())}function u(a){t(a)}function v(){y(!0)}function w(){y(!1)}function x(){y(!0)}function y(a){var b={},d="";if(n===null){b={response_type:"token",client_id:c.config.client_id},c.config.redirect_uri&&(b.redirect_uri=c.config.redirect_uri),a===!0&&(b.mode="popup"),d=h+i+"?"+o.serialize(b);if(a===!0){var e=window.open(d,"_geoloqi_auth_popup","height=500,width=700");window.focus&&e.focus()}else window.location=d}}function z(){return d.auth&&d.auth.access_token?!0:!1}function A(){d.auth=null,o.cookie.erase()}function B(a,b,c){arguments.length==3?D("GET",a,b,c):arguments.length==2&&D("GET",arguments[0],{},arguments[1])}function C(a,b,c){D("POST",a,b,c)}function D(c,e,f,g){var h=o.guid(),i={};if(!z())throw"Not logged in, no access_token is present. Authorize the user with geoloqi.authorize() first.";i={method:c,path:e,args:f,accessToken:d.auth.access_token,callbackId:h,version:a},b[h]=g,r.postMessage(JSON.stringify(i))}function E(a){if(a.origin!=h)return!1;var c=JSON.parse(a.data);typeof c.oauth=="object"?(typeof c.oauth.auth=="string"&&u(c.oauth.auth),typeof c.oauth.error=="string"&&d.onOAuthError!==null&&d.onOAuthError(c.oauth.error)):(typeof c.response=="string"&&(c.response=JSON.parse(c.response)),typeof c.error=="string"&&(c.error=JSON.parse(c.error)),b[c.callbackId](c.response,c.error))}var a="1.0.0",b={},c=this,d={},e="https://api.geoloqi.com",f="/js/",g=e+f+"receiver.html",h="https://geoloqi.com",i="/oauth/authorize",j=h+i,k=null,l="_geoloqi_auth",m={},n=null,o={},p=null,q=null,r=new easyXDM.Socket({remote:g,onMessage:function(a,c){if(c!=e&&c!=h)return!1;var f=JSON.parse(a);typeof f.oauth=="object"?(typeof f.oauth.auth=="string"&&u(f.oauth.auth),typeof f.oauth.error=="string"&&d.onOAuthError!==null&&d.onOAuthError(f.oauth.error)):(typeof f.response=="string"&&(f.response=JSON.parse(f.response)),typeof f.error=="string"&&(f.error=JSON.parse(f.error)),b[f.callbackId](f.response,f.error))}});return d.config=m,d.onAuthorize=p,d.onOAuthError=q,d.init=s,d.auth=n,d.authenticate=v,d.authenticateWithRedirect=v.authenticateWithRedirect,d.authenticateWithPopup=x,d.logged_in=z,d.expire=A,d.get=B,d.post=C,d.execute=D,d.receive=E,o.serialize=function(a){var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},o.objectify=function(a){var b={},c=/([^&=]+)=([^&]*)/g,d;while(d=c.exec(a))b[decodeURIComponent(d[1])]=decodeURIComponent(d[2]);return b},o.cookie=function(){function b(a,b){if(b){var c=new Date;c.setTime(c.getTime()+b*1e3);var d="; expires="+c.toGMTString()}else var d="";document.cookie=l+"="+a+d+"; path=/"}function c(){var a=l+"=",b=document.cookie.split(";");for(var c=0;c<b.length;c++){var d=b[c];while(d.charAt(0)==" ")d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return null}function d(){b("",-1)}var a={};return a.set=b,a.get=c,a.erase=d,a}(),o.guid=function(){return"g"+(Math.random()*(1<<30)).toString(16).replace(".","")},d}();window.addEventListener("message",function(a){geoloqi.receive(a)});if(typeof geoloqi=="undefined")var geoloqi={};geoloqi.maps=function(){var a={},b={};b.merge=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},a.setDefault=function(a){map instanceof google.maps.Map&&(c.map=a,c.pin.map=a,c.line.map=a,c.handle.map=a)},a.getMap=function(){return c.map},a.styles={},a.styles.define=function(c,d,e){e=typeof e=="undefined"?!1:e,a.styles[c]=b.merge(a.styles["default"],d),e?a.styles.setDefault(c):null},a.styles.setDefault=function(b){a.styles.default=a.styles[b]},a.styles.default={marker:{},circles:{count:1,fillColor:"#CE7F2C",fillOpacity:.2,strokeColor:"#CE7F2C",strokeWeight:2,strokeOpacity:.6},handle:{},line:{strokeColor:"#000",strokeWeight:2,strokeOpacity:.6},info:{useInfobox:!1}},a.styles.geoloqi_js=a.styles.default;var c={map:null,pin:{style:"default",map:null,visible:!0,clickable:!1,draggable:!0,editable:!0,radius:100,autopan:!1,toggleInfobox:!1},line:{clickable:!1,map:null},handle:{icon:a.styles["default"].handle.icon,shadow:a.styles["default"].handle.shadow,map:null,draggable:!0,raiseOnDrag:!1,clickable:!1,visible:!0},info:{useInfobox:!1,opened:!1,toggleInfoOnClick:!0,openAfterDrag:!0},events:{dragstart:null,dragend:null,drag:null,open:null,close:null,lock:null,unlock:null,radius_changed:null,position_changed:null,create:null,show:null,hide:null,click:null}};return a.helpers={},a.helpers.fitMapToRadius=function(a,b){var d=new google.maps.LatLngBounds,e=google.maps.geometry.spherical;d.extend(e.computeOffset(a,b,0)),d.extend(e.computeOffset(a,b,180)),d.extend(e.computeOffset(a,b,270)),d.extend(e.computeOffset(a,b,90)),c.map.fitBounds(d)},a.helpers.getIdealRadiusForMap=function(a){fraction=typeof a!="undefined"?100/a:4;var b=map.getBounds(),c=b.getNorthEast(),d=b.getSouthWest(),e=new google.maps.LatLng(d.lat(),c.lng());return google.maps.geometry.spherical.computeDistanceBetween(c,e)/fraction},a.pins={},a.pins.Basic=function(d,e){e=typeof e!="undefined"?e:!0;var f=function(){this.options=b.merge(c.pin,d),this.style=a.styles[this.options.style],this.options.icon=this.style.marker.icon,this.options.shadow=this.style.marker.shadow,this.options.position instanceof google.maps.LatLng==0&&(this.options.position=new google.maps.LatLng(this.options.position.latitude,this.options.position.longitude)),this.options.editable?d.draggable=!0:d.draggable=!1,this.events=b.merge(c.events,d.events),e?this.initPin():""};return f.prototype={centerHere:function(){return mapToPan=this.getMap(),mapToPan.panTo(this.getPosition()),this},showOnMap:function(a){return a=typeof a!="undefined"?a:c.map,this.marker.setVisible(!0),this.marker.setMap(a),google.maps.event.trigger(this.marker,"show"),this},removeFromMap:function(){return this.marker.setMap(null),google.maps.event.trigger(this.marker,"hide"),this},setDraggable:function(a){return this.marker.setDraggable(a),this},getDraggable:function(){return this.marker.getDraggable()},toggleDraggable:function(){return this.getDraggable()?this.setDraggable(!1):this.setDraggable(!0),this},getMap:function(){return this.marker.getMap()},moveTo:function(a,b){return b=typeof b=="undefined"?!1:b,a instanceof google.maps.LatLng==0&&(a=new google.maps.LatLng(a.latitude,a.longitude)),this.setPosition(a),b&&this.centerHere(),this},setPosition:function(a){return a instanceof google.maps.LatLng==0&&(a=new google.maps.LatLng(a.latitude,a.longitude)),this.marker.setPosition(a),this},getPosition:function(){return this.marker.getPosition()},initPin:function(){var a=this;this.marker=new google.maps.Marker(this.options),google.maps.event.addListener(this.marker,"dragstart",function(b){typeof a.events.dragstart=="function"?a.events.dragstart(b):null}),google.maps.event.addListener(this.marker,"drag",function(b){typeof a.events.drag=="function"?a.events.drag(b):null}),google.maps.event.addListener(this.marker,"dragend",function(b){a.options.autopan&&map.panTo(a.getPosition()),typeof a.events.dragend=="function"?a.events.dragend(b):null}),google.maps.event.addListener(this.marker,"position_changed",function(b){typeof a.events.position_changed=="function"?a.events.position_changed(b):null}),google.maps.event.addListener(this.marker,"click",function(b){typeof a.events.click=="function"?a.events.click(b):null}),typeof this.events.create=="function"?this.events.create():null}},new f},a.pins.WithRadius=function(d,e,f){f=typeof f!="undefined"?f:!0,e=typeof e!="undefined"?e:!0;var g=function(){this.options=b.merge(c.pin,d),this.style=a.styles[this.options.style],this.handleOptions=b.merge(c.handle,this.style.handle),this.handleOptions.position=new google.maps.LatLng(0,0),this.handleOptions.map=this.options.map,this.lineOptions=b.merge(c.line,this.style.line),this.lineOptions.map=this.options.map,this.hideCircles=function(){if(this.circles.length>0)for(var a=0;a<this.circles.length;a++)this.circles[a].circle.setMap(null);return this},this.showCircles=function(){if(this.circles.length>0)for(var a=0;a<this.circles.length;a++)this.circles[a].circle.setMap(this.getMap());return this},this.getRadius=function(){return this.circles[0].circle.getRadius()},this.setupCircles=function(a,b){a=typeof a!="undefined"?a:this.radius,b=typeof b!="undefined"?b:null,this.hideCircles(),this.circles=[];for(var c=0;c<this.style.circles.count;c++)this.circles.push({circle:new google.maps.Circle({center:this.getPosition(),radius:a-c*3,fillColor:this.style.circles.fillColor,fillOpacity:this.style.circles.fillOpacity,strokeColor:this.style.circles.strokeColor,strokeWeight:this.style.circles.strokeWeight,strokeOpacity:this.style.circles.strokeOpacity,map:b,zIndex:-1}),index:c}),this.circles[c].circle.bindTo("center",this.marker,"position");return google.maps.event.trigger(this.marker,"radius_changed"),this},this.updateHandle=function(){return this.handle.setPosition(google.maps.geometry.spherical.computeOffset(this.marker.getPosition(),this.getRadius(),135)),this},this.updateLine=function(){return this.line.setPath([this.getPosition(),this.handle.getPosition()]),this},this.hideHandle=function(){return this.line.setMap(null),this.handle.setMap(null),this},this.showHandle=function(){return this.line.setMap(this.getMap()),this.handle.setMap(this.getMap()),this},this.lockPin=function(){return this.setDraggable(!1),this.hideHandle(),this.isLocked=!0,google.maps.event.trigger(this.marker,"locked"),this},this.unlockPin=function(){return this.marker.setDraggable(!0),this.getMap()&&this.showHandle(),this.isLocked=!1,google.maps.event.trigger(this.marker,"unlocked"),this},this.toggleLock=function(){return this.isLocked?this.unlockPin():this.lockPin(),this},this.initRadius=function(){var b=this;this.line=new google.maps.Polyline(this.lineOptions),this.handle=new google.maps.Marker(this.handleOptions),this.circles=[],this.options.draggable=this.options.editable,this.options.editable?this.unlockPin():this.lockPin(),this.setupCircles(this.options.radius,this.options.map),this.updateHandle(),this.updateLine(),google.maps.event.addListener(this.marker,"hide",function(a){b.handle.setMap(null),b.line.setMap(null),b.hideCircles()}),google.maps.event.addListener(this.marker,"show",function(a){b.handle.setMap(b.getMap()),b.line.setMap(b.getMap()),b.showCircles()}),google.maps.event.addListener(this.marker,"position_changed",function(a){b.updateHandle(),b.updateLine()}),google.maps.event.addListener(this.marker,"dragstart",function(a){b.hideHandle()}),google.maps.event.addListener(this.marker,"drag",function(a){b.updateHandle()}),this.delayedHandle=!1,b.options.autopan?google.maps.event.addListener(c.map,"idle",function(a){!b.isLocked&&b.delayedHandle&&b.showHandle(),b.delayedHandle=!0}):google.maps.event.addListener(this.marker,"dragend",function(a){!b.isLocked&&b.delayedHandle&&b.showHandle(),b.delayedHandle=!0}),google.maps.event.addListener(this.handle,"drag",function(a){var c=google.maps.geometry.spherical,d=b.getPosition(),e=a.latLng,f=function(a){return a*(Math.PI/180)},g=c.computeHeading(d,e),h=45+g,i=c.computeDistanceBetween(d,e);newRadius=-1*Math.cos(f(h))*i,b.handle.setPosition(c.computeOffset(d,newRadius,135)),b.updateLine();for(var j=0;j<b.style.circles.count;j++)b.circles[j].circle.setRadius(newRadius-j*3)}),google.maps.event.addListener(this.handle,"dragend",function(d){var e=c.map.getBounds();e.contains(b.handle.getPosition())||a.helpers.fitMapToRadius(b.marker.getPosition(),b.getRadius()),google.maps.event.trigger(b.marker,"radius_changed")})},e?this.initRadius():""};return f?g.prototype=new a.pins.Basic(d):"",new g},a.pins.WithInfobox=function(d,e,f){f=typeof f!="undefined"?f:!0,e=typeof e!="undefined"?e:!0;var g=function(){this.options=b.merge(c.pin,d),this.style=a.styles[this.options.style],this.infoOptions=b.merge(b.merge(c.info,this.style.info),d),this.hideInfo=function(){return this.opened=!1,this.info.close(),google.maps.event.trigger(this.marker,"close"),this},this.showInfo=function(){return this.opened=!0,this.delayedInfobox=!0,this.info.open(c.map,this.marker),google.maps.event.trigger(this.marker,"open"),this},this.open=function(){return this.showInfo(),this},this.close=function(){return this.hideInfo(),this},this.toggleInfo=function(){return this.opened?this.hideInfo():this.showInfo(),this},this.setContent=function(a){return this.info.setContent(a),this},this.setInfo=function(a,b){return typeof b=="undefined"?!1:b,this.info?this.info.close():null,this.info=a,this.opened=b,b?this.info.open(c.map,this.marker):this.close(),google.maps.event.addListener(this.info,"close",function(){self.opened=!1}),google.maps.event.addListener(this.info,"closeclick",function(){self.opened=!1}),this},this.initInfobox=function(){var a=this;this.opened=this.infoOptions.opened,this.infoOptions.position=null,typeof this.options.content=="string"?this.infoOptions.useInfobox?this.setInfo(new InfoBox(this.infoOptions)):(console.log(this.infoOptions),this.setInfo(new google.maps.InfoWindow(this.infoOptions))):this.options.content instanceof InfoBox||this.options.content instanceof google.maps.InfoWindow?(this.setInfo(this.options.content),this.options.toggleInfoOnClick=!0,this.opened=!1):this.info=null,console.log(this.infoOptions.toggleInfoOnClick),this.infoOptions.toggleInfoOnClick?(this.isClickable=!0,this.marker.setClickable(!0),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(b){a.toggleInfo()})):(this.isClickable=!1,this.marker.setClickable(!1),typeof this.clickEvent=="object"&&google.maps.event.removeListener(this.clickEvent)),google.maps.event.addListener(this.marker,"dragstart",function(b){a.hideInfo()}),this.delayedInfobox=!1,a.options.autopan?google.maps.event.addListener(c.map,"idle",function(b){!a.opened&&a.options.openAfterDrag&&a.delayedInfobox&&a.showInfo()}):google.maps.event.addListener(this.marker,"dragend",function(b){!a.opened&&a.options.openAfterDrag&&a.delayedInfobox&&a.showInfo()}),google.maps.event.addListener(this.marker,"hide",function(a){this.info.close()}),google.maps.event.addListener(this.marker,"open",function(b){typeof a.events.open=="function"?a.events.open(a):null}),google.maps.event.addListener(this.marker,"close",function(b){typeof a.events.close=="function"?a.events.close(a):null}),this.opened&&a.showInfo()},e?this.initInfobox():null};return f?g.prototype=new a.pins.Basic(d):null,new g},a.pins.WithInfoboxAndRadius=function(c,d,e){e=typeof e!="undefined"?e:!0,d=typeof d!="undefined"?d:!0;var f=function(){this.initInfoboxAndRadius=function(){var a=this;google.maps.event.addListener(this.handle,"dragstart",function(b){a.opened&&a.options.openAfterDrag&&a.hideInfo()}),google.maps.event.addListener(this.handle,"dragend",function(b){!a.opened&&a.options.openAfterDrag&&a.showInfo()})},d&&(this.initRadius(),this.initInfobox(),this.initInfoboxAndRadius())};return f.prototype=b.merge(new a.pins.WithRadius(c,!1,!0),new a.pins.WithInfobox(c,!1,!1)),new f},a.InfoBox=function(d,e){return style=typeof e=="undefined"?a.styles.default:a.styles[e],options=b.merge(c.info,style.info),options.content=d,new InfoBox(options)},a}();if(typeof geoloqi=="undefined")var geoloqi={};geoloqi.Socket=function(a,b,c){var d=function(){c=typeof c=="undefined"?{}:c;var d=this,e="https://subscribe.geoloqi.com:443";this.auth=b,this.type=a,this.events={start:c.start||null,location:c.location||null,disconnect:c.disconnect||null},this.socket=io.connect(e),this.start=function(){this.socket.on("enter authentication",function(a){d.socket.emit("token",d.type+"-"+d.auth),d.events.start}),this.socket.on("location",function(a){var a=JSON.parse(a);d.events.location(a)}),this.socket.on("disconnect",d.events.disconnect)}};return new d};